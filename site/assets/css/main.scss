$debug: false;
$theme: auto;

$tiny: 400px;
$reduced: 950px;

@if ($debug) {
	* {
		outline: 1px solid red !important;
		box-sizing: border-box;
	}
}

@import "theme";

:root {
	--font-size: 16px;
	@media (max-width: $tiny) {
		--font-size: 14px;
	}
	--line-height: 1.5;
	--baseline: calc(var(--font-size) * var(--line-height));
	--halfbase: calc(var(--baseline) / 2);

	/* Header/Footer layout */
	--header-step:   3;
	--header-height: calc(var(--header-step) * var(--baseline));
	--header-bottom: var(--baseline);

	/* Heading layout */
	--heading-step:   3;
	--heading-height: calc(var(--heading-step) * var(--baseline));
	--heading-bottom: var(--baseline);

	/* Icon sizing */
	--icon-size-constant: 16px;
	--icon-size-dynamic:  calc(var(--font-size) * 1.2);
	--icon-scale:         var(--icon-size-constant);
	--icon-spacing:       0.5ch;

	/* Fonts */
	--sans-serif: "Open Sans", "Trebuchet MS", "DejaVu Sans", "Geneva", sans-serif;
	--monospace:  "Consolas", "DejaVu Sans Mono", monospace;

	/* Horizontal spacing */
	--indent-full:      4ch;
	--indent-half:      calc(var(--indent-full)/2);
	--indent:           var(--indent-full); /* Dynamic */
	--section-spacing:  2ch;

	/* Z Layers */
	--layer-content:          auto;
	--layer-below-foreground: 10;
	--layer-foreground:       20;
	--layer-menu:             30;

	/* Misc. */
	--scrollbar-width: 4ch;
}

html {
	display: flex;
	flex-direction: column;
	height: 100%;

	background-color: var(--theme-MainBackground);
	color: var(--theme-MainText);
}

@mixin running-center-text {
	display: flex;
	align-items: center;
	gap: 0 0.25em;

	min-height: calc(var(--header-step) * var(--baseline));

	@media (max-width: $reduced) {
		--header-step: 2;
	}
}
@mixin running-button {
	transition: background-color 100ms linear, color 100ms linear;
	&:hover {
		background-color: var(--theme-Tab-Hover);
	}
}

@mixin running-padding {
	padding-left: var(--halfbase);
	padding-right: var(--halfbase);
}

body {
	flex: 1 0 auto;

	display: flex;
	flex-direction: column;
	height: 100%;

	font: var(--font-size)/var(--line-height) var(--sans-serif);
	margin: 0;
	padding: 0;

	> header, > footer {
		:not(span) :not(span) {
			@include running-center-text;
		}
		h1 {
			margin: 0;
			> a {
				@include running-padding;
			}
		}
		nav {
			flex: 1 1 auto;

			display: flex;
			align-items: stretch;
			gap: 0;

			ul {
				display: flex;
				flex-flow: wrap row;
				gap: 0;

				list-style-type: none;
				margin: 0;
				padding: 0;
				li {
					display: flex;
					align-items: stretch;
					gap: 0;

					a {
						@include running-button;
						@include running-padding;
					}
				}
			}
		}
	}
	> header {
		display: grid;
		grid-template-columns: 1fr auto;

		background-color: var(--theme-Tab);
		> div:first-child {
			display: flex;
			align-items: center;
			flex-flow: wrap row;
			gap: 0;

			> aside {
				> #no-search {
					@media (max-width: $reduced) {
						display: none;
					}
					@include running-padding;
				}
				&:has(> #no-search) {
					@media (max-width: $reduced) {
						display: none;
					}
				}
			}
		}
		> div:last-child {
			display: flex;
			gap: 0;
		}
	}
	> main {
		flex: 1 0 auto;
		margin: var(--halfbase);
		&.article {
			max-width: 90ch;
			margin: var(--halfbase) auto;
		}
	}
	> footer {
		flex-shrink: 0;

		display: flex;
		align-items: center;
		flex-flow: wrap row;
		gap: 0;

		background-color: var(--theme-footer);
		color: var(--theme-footer-text);
		padding-bottom: var(--baseline);

		a[href] {
			color: var(--theme-footer-text);
			&:hover {
				color: var(--theme-footer-text-hover);
				background-color: var(--theme-footer-hover);
			}
		}
		> span {
			@include running-padding;
		}
		.license {
			padding: var(--halfbase);
			a[href] {
				white-space: nowrap;
			}
		}
		.publication {
			margin-left: auto;
			padding: var(--halfbase);
			svg {
				height: 14px;
				width: 14px;
			}
			path {
				fill: var(--theme-DialogMainButtonText);
			}
		}
	}
}

a[href] {
	color: var(--theme-link);
	text-decoration: none;
}

h1,h2,h3,h4,h5,h6 {
	--heading-font-size: calc(var(--heading-scale,1) * var(--font-size));
	font-size:           var(--heading-font-size);
	line-height:         var(--line-height);
	margin-bottom:       var(--heading-bottom);
	margin-top:          calc(var(--heading-height) - var(--heading-bottom) - var(--heading-font-size)*var(--line-height));
	margin-left:         0;
	margin-right:        0;
}
h1 { --heading-scale: calc(12/6) }
h2 { --heading-scale: calc(9/6) }
h3 { --heading-scale: calc(7/6) }
h4 { --heading-scale: calc(6/6) }
h5 { --heading-scale: calc(5/6) }
h6 { --heading-scale: calc(4/6) }
